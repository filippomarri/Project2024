<html>
    <head></head>
    <body>
        <div id="container">
            <h1>What is the sound of colours?</h1>

            <div className="App">
                <canvas id="DemoCanvas" width="200" height="80"></canvas>
              </div>
              <input type="button" id="btn" value="Play">
        
            <output></output>
            <div>   <input type="file" id="fileinput" accept = "image/*">  </div>
        </div>

        <style>
            html, body {
                height: 100%;
                display: block;
                margin: 0;
                padding: 0;
                font-family: Arial, Helvetica, sans-serif;
            }
            
            h1 {
                margin: 0;
                padding: 10px 0;
            }

            canvas {
                border: 1px solid red;
                padding-left: 0;
                padding-right: 0;
                margin-left: auto;
                margin-right: auto;
                display: block;
            }

        </style>

        <script>

            

            var left = 0;

            const btn = document.getElementById("btn");
            canvas = document.getElementsByTagName("canvas")[0];
            ctx = canvas.getContext("2d");

            function resizeCanvas(){
                // Resize to the screen
                if(canvas.width != (window.innerWidth - 50) || canvas.width != (window.innerWidth - 50)){
                    canvas.width = window.innerWidth - 50;
                    canvas.height = window.innerHeight - 50;
                }
            }

            resizeCanvas();

            // upload image
            let fileInput = document.getElementById('fileinput');
            fileInput.addEventListener('change', function(ev){
                if(ev.target.files){
                    let file = ev.target.files[0];
                    var reader  = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onloadend = function (e) {
                        var image = new Image();
                        image.src = e.target.result;
                        image.onload = function(ev) {
                            //canvas.width = image.width;
                            //canvas.height = image.height;
                            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height);
                        }
                    }
                }
            });

            let xPos = 0;
            let playing = false;

            function updateVert() {
                if(!playing) {
                    cancelAnimationFrame(updateVert);
                    return;
                }
                
                // speed of the line
                xPos += 0.3;
                
                if(xPos >= canvas.width) {
                    // stop animation...
                    xPos = 0;
                    playing = false;
                    btn.value = "Play";
                }
                
                // reset rectangle content to erase previous line...
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // draw new one...
                ctx.beginPath();
                ctx.strokeStyle = "black";
                ctx.lineWidth = 3;
                ctx.moveTo(xPos, 0);
                ctx.lineTo(xPos, canvas.width);
                ctx.stroke();
                
                if(playing) requestAnimationFrame(updateVert);
            }

            document.getElementById("btn").addEventListener('click', function(e){
                e.preventDefault();

                if(playing) {
                    // pause...
                    playing = false;
                }
                else {
                    playing = !playing;
                    updateVert();
                }
                
                btn.value = playing?"Pause":"Play";
            });

        </script>
    </body>
</html>